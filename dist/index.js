var e,t=require("react"),r=(e=t)&&"object"==typeof e&&"default"in e?e.default:e;function n(e){return e.num>=2147483647?r.createElement("span",null,"∞ "):r.createElement("span",null,e.num%1!=0?e.num.toFixed(2):e.num.toString()," ")}function a(e){var t=r.useState(!1)[1];if(!Array.isArray(e.details)||0===e.details.length)return null;var n=r.createElement("div",null,r.createElement("h3",{style:{marginBlockStart:0,marginBlockEnd:0}},e.title),r.createElement("ul",{style:{marginBlockStart:5,marginBlockEnd:5}},e.details.map(function(e,t){return r.createElement("li",{key:t},e)})));return r.createElement("span",{style:{marginLeft:"0.2rem",color:"gray",borderBottom:"1px dotted gray",cursor:"pointer",position:"relative"},onMouseEnter:function(){return t(!0)},onMouseLeave:function(){return t(!1)}},"ℹ",r.createElement("div",{style:{display:"block",zIndex:1e3,position:"absolute",borderRadius:"5px",backgroundColor:"#111",color:"white",bottom:15,width:170,padding:5,right:-50}},n))}function l(e){var t=e.characteristics,l=t.typeCounts&&Object.keys(t.typeCounts).map(function(e){return r.createElement("span",null,e,": ",r.createElement(n,{num:t.typeCounts[e]}))})||null,i=t.fieldCounts&&Object.keys(t.fieldCounts).map(function(e){return r.createElement("span",null,e,": ",r.createElement(n,{num:t.fieldCounts[e]}))})||null;return r.createElement("div",{style:{padding:"0.5em 0 0.5em 0.5em"}},r.createElement("h3",{style:{marginBlockStart:"0.2em",marginBlockEnd:0}},"Query cost"),r.createElement("div",{style:{paddingLeft:"0.5em"}},"Type cost: ",r.createElement(n,{num:t.typeCost}),r.createElement(a,{title:"Type counts",details:l})," "),r.createElement("div",{style:{paddingLeft:"0.5em"}},"Field cost: ",r.createElement(n,{num:t.fieldCost}),r.createElement(a,{title:"Field counts",details:i})," "))}function i(e,t){return 0===e||0===t?Number.MAX_SAFE_INTEGER:Math.floor(e/t)}function m(e){var t=e.timeFrame,l=e.limits,m=e.characteristics,c=l.find(function(e){return"typeCost"===e.name}),o=l.find(function(e){return"fieldCost"===e.name}),s=m.typeCounts&&Object.keys(m.typeCounts).map(function(e){return r.createElement("span",null,e,": ",r.createElement(n,{num:m.typeCounts[e]}))})||null,u=m.fieldCounts&&Object.keys(m.fieldCounts).map(function(e){return r.createElement("span",null,e,": ",r.createElement(n,{num:m.fieldCounts[e]}))})||null;return r.createElement("div",null,r.createElement("h4",{style:{marginBlockStart:"0.3em",marginBlockEnd:0}},"Limits for ",t.interval," ",t.unit,":"),r.createElement("div",null,c?r.createElement("span",{style:{paddingLeft:"0.5em"}},r.createElement(n,{num:i(c.rate,m.typeCost)}),"times for type cost of ",r.createElement(n,{num:m.typeCost}),r.createElement(a,{title:"Type counts",details:s})):r.createElement("span",{style:{color:"gray",paddingLeft:"0.5em"}},"No limit defined for type cost")),r.createElement("div",null,o?r.createElement("span",{style:{paddingLeft:"0.5em"}},r.createElement(n,{num:i(o.rate,m.fieldCost)}),"times for field cost of ",r.createElement(n,{num:m.fieldCost}),r.createElement(a,{title:"Field counts",details:u})):r.createElement("span",{style:{color:"gray",paddingLeft:"0.5em"}},"No limit defined for field cost")))}function c(){return r.createElement("div",{style:{width:0,height:0,borderTop:"8px solid transparent",borderBottom:"8px solid transparent",borderRight:"8px solid #444",float:"right"}})}function o(e,t,r){Array.isArray(e)&&0!==e.length&&e.forEach(function(e){var n=t.find(function(t){return t.timeFrame.interval===e.interval&&t.timeFrame.unit===e.unit});n?n.limits.push({name:r,rate:e.rate}):t.push({timeFrame:{interval:e.interval,unit:e.unit},limits:[{name:r,rate:e.rate}]})})}function s(e){var a,l,i,s=e.characteristics,u=e.rateLimits,d=t.useState(null),E=d[0],p=d[1],f=null==(a=u.assemblyRateLimits)?void 0:a["graphql-field-cost"],y=null==(l=u.assemblyRateLimits)?void 0:l["graphql-type-cost"],g=null==(i=u.assemblyRateLimits)?void 0:i["graphql-type-cost"],v=[];o(f,v,"fieldCost"),o(y,v,"typeCost"),o(g,v,"inputTypeCost");var h=E?r.createElement(m,{timeFrame:E.timeFrame,characteristics:s,limits:E.limits}):null,b=r.createElement("div",null,r.createElement("h3",{style:{marginBlockStart:"0.2em",marginBlockEnd:0}},"Query limits:"),v.map(function(e,t){var a=function(e,t){var r=Number.MAX_SAFE_INTEGER;return e.forEach(function(e){var n=e.rate,a=t[e.name],l="number"==typeof a&&0!==a&&0!==n?Math.floor(n/a):Number.MAX_SAFE_INTEGER;l<r&&(r=l)}),r}(e.limits,s),l=!!E&&e.timeFrame.interval===E.timeFrame.interval&&e.timeFrame.unit===E.timeFrame.unit,i=r.createElement("span",{onClick:function(){return t=e,void p(E&&E.timeFrame.interval===t.timeFrame.interval&&E.timeFrame.unit===t.timeFrame.unit?null:t);var t},style:{fontStyle:"italic",textDecorationStyle:"dotted",cursor:"pointer",paddingLeft:10}},l?"hide...":"more...");return r.createElement("div",{key:t,style:{paddingLeft:"0.5em"}},r.createElement(n,{num:a}),"times per ",e.timeFrame.interval," ",e.timeFrame.unit,i,l?r.createElement(c,null):null)})),C=h?r.createElement(r.Fragment,null,r.createElement("div",{style:{width:250,padding:"0.5em 0 0.5em 0.5em"}},b),r.createElement("div",{style:{flex:1,backgroundColor:"#444",color:"white",padding:"0.5em 0 0.5em 0.5em"}},h)):r.createElement(r.Fragment,null,r.createElement("div",{style:{flex:1,padding:"0.5em 0 0.5em 0.5em"}},b));return r.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",height:"100%"}},C)}exports.CostPlugin=function(e){var t,n=e.costData;switch(e.dataAvailability){case"NONE":t=r.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"No data yet");break;case"LOADING":t=r.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"Loading...");break;case"ERROR":var a="Error loading cost data";if("object"==typeof n&&n&&n.errors){var i=Array.isArray(n.errors)?n.errors:[n.errors];a=r.createElement("ul",null,i.map(function(e){return r.createElement("li",null,e&&e.message||"")}))}t=r.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},a);break;case"AVAILABLE":t="object"==typeof n&&"object"==typeof n.request&&"object"==typeof n.rateLimits?r.createElement(s,{characteristics:n.request,rateLimits:n.rateLimits}):"object"==typeof n.request?r.createElement(l,{characteristics:n.request}):r.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"Error rendering cost data")}return r.createElement("div",{className:"qcs_wrapper"},t)};
//# sourceMappingURL=index.js.map
